---
- ruleID: "ejb-mdb-to-reactive-messaging"
  message: |
    Message-Driven Beans (MDBs) require migration to **Reactive Messaging** in Quarkus. Quarkus does not support traditional JMS-based MDBs.

    **Before (Jakarta EE MDB with JMS):**
    ```java
    import jakarta.ejb.MessageDriven;
    import jakarta.jms.MessageListener;
    import jakarta.jms.Message;
    import jakarta.jms.TextMessage;

    @MessageDriven(mappedName = "jms/OrderQueue")
    public class OrderProcessorMDB implements MessageListener {
        public void onMessage(Message message) {
            TextMessage textMessage = (TextMessage) message;
            String orderData = textMessage.getText();
            // Process order
        }
    }
    ```

    **After (Quarkus Reactive Messaging with Kafka):**
    ```java
    import jakarta.enterprise.context.ApplicationScoped;
    import org.eclipse.microprofile.reactive.messaging.Incoming;
    import org.eclipse.microprofile.reactive.messaging.Message;

    @ApplicationScoped
    public class OrderProcessor {
        @Incoming("orders-in")
        public void processOrder(Message<String> message) {
            String orderData = message.getPayload();
            // Process order
        }
    }
    ```

    **Key Changes:**
    - Replace `@MessageDriven` with `@ApplicationScoped` + `@Incoming`
    - Configure channel in `application.properties`
    - Use Kafka, RabbitMQ, or AMQP instead of JMS
    - Add `quarkus-smallrye-reactive-messaging-kafka` extension
  description: "Detects Java annotation: jakarta.ejb.MessageDriven"
  category: "mandatory"
  effort: 5
  labels:
    - "konveyor.io/source=jakarta-ee"
    - "konveyor.io/target=quarkus"
  links:
    - title: "EJB to Quarkus Migration Guide"
      url: "https://www.the-main-thread.com/p/from-heavyweight-to-hyperspeed-your"
    - title: "Quarkus Reactive Messaging"
      url: "https://quarkus.io/guides/kafka"
  tag: []
  customVariable: []
  when:
    java.referenced:
      pattern: "jakarta.ejb.MessageDriven"
      location: "ANNOTATION"
