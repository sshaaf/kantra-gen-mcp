---
- ruleID: "ejb-transaction-attribute-to-transactional"
  message: |
    EJB `@TransactionAttribute` should be replaced with `@Transactional` in Quarkus CDI beans.

    **Before (Jakarta EE EJB):**
    ```java
    import jakarta.ejb.Stateless;
    import jakarta.ejb.TransactionAttribute;
    import jakarta.ejb.TransactionAttributeType;

    @Stateless
    public class OrderService {
        @TransactionAttribute(TransactionAttributeType.REQUIRED)
        public void createOrder(Order order) {
            // Business logic
        }

        @TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
        public void auditOrder(Order order) {
            // Audit in new transaction
        }
    }
    ```

    **After (Quarkus CDI):**
    ```java
    import jakarta.enterprise.context.ApplicationScoped;
    import jakarta.transaction.Transactional;

    @ApplicationScoped
    public class OrderService {
        @Transactional(Transactional.TxType.REQUIRED)
        public void createOrder(Order order) {
            // Business logic
        }

        @Transactional(Transactional.TxType.REQUIRES_NEW)
        public void auditOrder(Order order) {
            // Audit in new transaction
        }
    }
    ```

    **Transaction Type Mappings:**
    | EJB | CDI |
    |-----|-----|
    | `REQUIRED` | `TxType.REQUIRED` |
    | `REQUIRES_NEW` | `TxType.REQUIRES_NEW` |
    | `MANDATORY` | `TxType.MANDATORY` |
    | `SUPPORTS` | `TxType.SUPPORTS` |
    | `NOT_SUPPORTED` | `TxType.NOT_SUPPORTED` |
    | `NEVER` | `TxType.NEVER` |
  description: "Detects Java annotation: jakarta.ejb.TransactionAttribute"
  category: "mandatory"
  effort: 2
  labels:
    - "konveyor.io/source=jakarta-ee"
    - "konveyor.io/target=quarkus"
  links:
    - title: "EJB to Quarkus Migration Guide"
      url: "https://www.the-main-thread.com/p/from-heavyweight-to-hyperspeed-your"
    - title: "Quarkus Transaction Guide"
      url: "https://quarkus.io/guides/transaction"
  tag: []
  customVariable: []
  when:
    java.referenced:
      pattern: "jakarta.ejb.TransactionAttribute"
      location: "ANNOTATION"
