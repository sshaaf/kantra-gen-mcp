---
- ruleID: "struts-action-to-spring-controller"
  message: |
    Struts `Action` classes must be converted to Spring MVC `@Controller` classes.

    **Before (Struts Action):**
    ```java
    package com.example.action;

    import org.apache.struts.action.*;
    import javax.servlet.http.*;

    public class ListItemsAction extends Action {
        private ItemDAO itemDAO = new ItemDAO();

        public ActionForward execute(ActionMapping mapping, ActionForm form,
                HttpServletRequest request, HttpServletResponse response) {
            List<Item> items = itemDAO.findAll();
            request.setAttribute("items", items);
            return mapping.findForward("success");
        }
    }
    ```

    **After (Spring Controller):**
    ```java
    package com.example.controller;

    import org.springframework.stereotype.Controller;
    import org.springframework.web.bind.annotation.*;
    import org.springframework.ui.Model;

    @Controller
    @RequestMapping("/items")
    public class ItemController {
        private final ItemRepository itemRepository;

        public ItemController(ItemRepository itemRepository) {
            this.itemRepository = itemRepository;
        }

        @GetMapping("/list")
        public String listItems(Model model) {
            List<Item> items = itemRepository.findAll();
            model.addAttribute("items", items);
            return "item/list";
        }
    }
    ```

    **Key Changes:**
    - Package: `*.action.*` â†’ `*.controller.*`
    - Remove `extends Action`
    - Add `@Controller` + `@RequestMapping`
    - Replace `execute()` with `@GetMapping`/`@PostMapping` methods
    - Use constructor injection instead of field initialization
    - Replace `request.setAttribute()` with `model.addAttribute()`
    - Replace `mapping.findForward()` with view name string
  description: "Detects Java inheritance: org.apache.struts.action.Action"
  category: "mandatory"
  effort: 4
  labels:
    - "konveyor.io/source=struts"
    - "konveyor.io/target=springboot"
  links:
    - title: "Struts to Spring Boot Migration Spec"
      url: "https://github.com/migtools/getting-started/blob/main/struts-1.0/spec.md"
    - title: "Spring MVC Controllers"
      url: "https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller.html"
  tag: []
  customVariable: []
  when:
    java.referenced:
      pattern: "org.apache.struts.action.Action"
      location: "INHERITANCE"
